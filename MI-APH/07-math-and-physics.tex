\section*{PÅ™ednÃ¡Å¡ka 7 -- HernÃ­ matematika a fyzika}

\subsection*{Dynamika}

\medskip

\subsubsection*{Body a vektory}

\medskip

\begin{description}
    \item[Vektor] VeliÄina, kterÃ¡ mÃ¡ velikost i smÄ›r.
    \item[Velikost] (\textit{Magnitude}) SkalÃ¡r reprezentujÃ­cÃ­ dÃ©lku vektoru (\(|a| = \sqrt{a_x^2 + a_y^2 + a_z^2}\)).
    \item[NormÃ¡lovÃ½ vektor] Vektor kolmÃ½ k povrchu.
    \item[SkalÃ¡rnÃ­ souÄin] \(a \cdot b = a_xb_x + a_yb_y + a_zb_z\) pÅ™Ã­padnÄ› \(a \cdot b = |a| \cdot |b| \cdot \cos{\theta}\).
\end{description}

\subsubsection*{Verletova integrace}

NumerickÃ¡ metoda vÃ½poÄtu pouÅ¾Ã­vanÃ¡ k integrovÃ¡nÃ­ rovnic pohybu.
PouÅ¾Ã­vÃ¡ se napÅ™. pÅ™i vÃ½poÄtu balistickÃ© kÅ™ivky (konkrÃ©tnÄ› Velocity Verlet, kterÃ½ mÃ¡ oproti EulerovskÃ© metodÄ› vÃ½hodu pÅ™i vÃ½poÄtech s vÃ­ce objekty).

\subsection*{Steering behaviors}

MnoÅ¾ina algoritmÅ¯ a principÅ¯ pro pohyb autonomnÃ­ch agentÅ¯ realistickÃ½m zpÅ¯sobem.
Agentem nazÃ½vÃ¡me systÃ©m umÃ­stÄ›nÃ½ v prostÅ™edÃ­.

RozliÅ¡ujeme vÃ­ce typÅ¯ tÄ›chto chovÃ¡nÃ­.

\begin{description}
    \item[Seek] SÃ­la smÄ›rujÃ­cÃ­ agenta k cÃ­lovÃ© pozici.
    \item[Flee] Protiklad \textit{seek}.
    \item[Arrive] Pohybuje agentem tak, Å¾e ho zpomaluje pÅ™i pÅ™iblÃ­Å¾enÃ­ k cÃ­li. PÅ™idÃ¡vÃ¡ se parametr \texttt{slowingRadius}.
    \item[Pursuit] Agent sleduje cÃ­l a predikuje kde se v budoucnu bude nachÃ¡zet.
    \item[Evade] Agent unikÃ¡ od pÅ™edpoklÃ¡danÃ© budoucÃ­ pozice cÃ­le.
    \item[Wander] VytvÃ¡Å™Ã­ sÃ­lu, kterÃ¡ budÃ­ dojem \textit{nÃ¡hodnÃ© prochÃ¡zky}.
    \item[Path follow] Agent sleduje mnoÅ¾inu pÅ™edem dannÃ½ch bodÅ¯ (koneÄnÃ½ pomocÃ­ \textit{arrive}, ostatnÃ­ pomocÃ­ \textit{seek}).
    \item[Obstacle avoidance] Vede agenta tak, aby se vyhÃ½bal pÅ™ekÃ¡Å¾kÃ¡m.
    \item[Offset pursuit] DrÅ¾Ã­ agenta v urÄitÃ© pozici oproti \textit{leaderovi}. VhodnÃ© napÅ™. pro bitevnÃ­ pozice. 
\end{description}

\subsection*{FyzikÃ¡lnÃ­ enginy}

SystÃ©m, kterÃ½ simuluje fyzikÃ¡lnÃ­ chovÃ¡nÃ­.
Simulace probÃ­hÃ¡ v reÃ¡lnÃ©m Äase.

\img{physics-engine-loop.png}{SmyÄka fyzikÃ¡lnÃ­ho enginu}{physics-engine-loop}{0.2}

\subsubsection*{Pojmy}

\medskip

\begin{description}
    \item[Rigid body] IdealizovanÃ©, nedeformovatelnÃ© objekty. DÄ›lÃ­ se do tÅ™Ã­ kategoriÃ­:
        \begin{itemize}
            \item Physics driven -- Å™Ã­zenÃ½ pouze simulacÃ­,
            \item Game driven -- pohybujÃ­cÃ­ se nepÅ™irozenÃ½m stylem (napÅ™. animace),
            \item Fixed -- objekty urÄenÃ© pouze k detekci kolizÃ­.
        \end{itemize}
    \item[Constraint] Spojuje \textit{bodies} tak, aby simuloval interakce mezi nimi (Å™etÄ›zy, provazy, kola, \dots).
\end{description}

\subsubsection*{Constraints}

RozliÅ¡ujeme mnoho typÅ¯ \textit{constraints}, napÅ™.:

\begin{description}
    \item[Revolute] Bod, kde se \textit{bodies} otÃ¡ÄÃ­ (kola, Å™etÄ›zy, otoÄnÃ© dveÅ™e, \dots).
    \item[Prismatic] Objekt se pohybuje jen pod urÄitÃ½m Ãºhlem (vÃ½tah, posuvnÃ© dveÅ™e, \dots).
    \item[Cone-twist] PÅ™idÃ¡vÃ¡ cones \& twist limits (?).
\end{description}

\img{constraints.png}{PÅ™Ã­klady constraints}{constraints}{0.6}

\subsubsection*{Primitiva}

RozliÅ¡ujeme zÃ¡kladnÃ­ primitiva, ze kterÃ½ch se sklÃ¡dajÃ­ sloÅ¾itÄ›jÅ¡Ã­ objekty:

\begin{description}
    \item[Sphere] Kruh, koule -- definovÃ¡no 4 bodami (\(x, y, z + \textrm{radius}\))
    \item[Capsule] KruÅ¾nice se Ätvercem, pÅ™Ã­padnÄ› kvÃ¡dr s koulÃ­ -- definovÃ¡no dvÄ›ma body a prÅ¯mÄ›rem.
    \item[AABB] \textit{Axis-aligned bouding box}. KvÃ¡dr, jehoÅ¾ hrany jsou rovnobÄ›Å¾nÃ© s osami. EfektivnÃ­ na hledÃ¡Ã­ prÅ¯nikÅ¯.
    \item[OBB] \textit{Oriented bounding box}.
\end{description}

\img{primitives-example.png}{UkÃ¡zka primitiv}{primitives-example}{0.8}

\subsubsection*{Detekce kolizÃ­}

\medskip

\subsubsection*{Separating axis theorem (SAT)}

Detekce kolize dvou rovnobÄ›Å¾nÃ­kÅ¯ se dÄ›lÃ¡ na zÃ¡kladÄ› projekcÃ­ na osy.
Pro oba objekty vezmeme jejich osy s nimi rovnobÄ›Å¾nÃ©.
Pokud existuje alespoÅˆ jedna osa, kde se projekce neprotÃ­najÃ­, pak se ani objekty neprotÃ­najÃ­.

\subsubsection*{Collision query}

Operace pouÅ¾Ã­vanÃ© k zodpovÄ›zenÃ­ otÃ¡zek jako \uv{\textit{KterÃ½ objekt kulka trefÃ­ jako prvnÃ­?}}, \uv{\textit{JakÃ© objekty se vyskytujÃ­ v danÃ©m polomÄ›ru?}}

\subsubsection*{Reakce na kolize}

\begin{description}
    \item[Explosion] PÅ™idÃ¡nÃ­ energie systÃ©mu \textit{rigidnÃ­ch tÄ›les}.
    \item[Friction] (\textit{TÅ™enÃ­}) OdebÃ­rÃ¡nÃ­ energie systÃ©mu \textit{rigidnÃ­ch tÄ›les}.
    \item[Restitution] Velikost odrazu po stÅ™etu s nÄ›ÄÃ­m (?).
    \item[Friction] (\textit{znovu?}) SÃ­la vznikajÃ­cÃ­ mezi dvÄ›ma tÄ›lesy, kterÃ© jsou v kontaktu delÅ¡Ã­ dobu.
    \begin{itemize}
        \item \textit{Static} -- Oproti povrchu.
        \item \textit{Dynamic} -- Objekty se pohybujÃ­ relativnÄ› k sobÄ›.
        \item \textit{Rolling} -- Bod dotyku mezi povrchem a kolem.
    \end{itemize}
\end{description}

\subsubsection*{ÄŒÃ¡sticovÃ© systÃ©my}

Kolekce bodÅ¯ hmoty, kterÃ© odpovÃ­dajÃ­ nÄ›jakÃ©mu konkrÃ©tnÃ­mu fyzikÃ¡lnÃ­mu zÃ¡konu.
HojnÄ› vyuÅ¾Ã­vÃ¡ \textit{FlyWeight pattern}.
MajÃ­ monho atributÅ¯ (zrychlenÃ­, orientace, pozice, hmota, velikost, \dots).
NapÅ™. oheÅˆ, voda, dÃ©Å¡Å¥, kouÅ™, mlha, \dots

\subsection*{Prostor}

\medskip

\subsubsection*{DÄ›lenÃ­ prostoru}

Struktury udrÅ¾ujÃ­cÃ­ objekty podle jejich pozice.
PouÅ¾Ã­vajÃ­ se k hledÃ¡nÃ­ sousedÅ¯, analyzovÃ¡nÃ­ tvarÅ¯ atd.

ImplementovÃ¡no napÅ™. pomocÃ­ \textit{Grid}, \textit{Quad-tree} (2D), \textit{Octree} (3D), binÃ¡rnÃ­ho vyhledÃ¡vacÃ­ho stromu, \dots

\begin{description}
    \item[Grid] KaÅ¾dÃ¡ buÅˆka mÃ¡ seznam prvkÅ¯ uvnitÅ™, ideÃ¡lnÃ­ pro velkÃ© mnoÅ¾stvÃ­ objektÅ¯ stejnÃ© velikosti.
    \item[Quad-tree] HierarchickÃ¡ struktura, kde kaÅ¾dÃ½ uzel mÃ¡ prÃ¡vÄ› 4 nÃ¡slednÃ­ky. Objekty jsou umÃ­stÄ›ny v listech. DobrÃ© pro malÃ© mnoÅ¾stvÃ­ objektÅ¯ rÅ¯znÃ© velikosti. 
\end{description}

\subsubsection*{Rotace}

\begin{description}
    \item[Eulerovy Ãºhly] JednoduchÃ¡ reprezentace (3 ÄÃ­sla -- 3 osy), ale trpÃ­ na \textit{gimbal lock} -- ztrÃ¡tu moÅ¾nosti otÃ¡ÄenÃ­ se po jednÃ© ose pÅ™e natoÄenÃ­ o \(90^\circ\).
    \item[Matice] NetrpÃ­ na \textit{gimbal lock}, ale jsou neintuitivnÃ­, zaberou vÃ­ce mÃ­sta a nelze je jednoduÅ¡e interpolovat.
    \item[Axis + angle] PomocÃ­ osy a Ãºhlu (\([a_x, a_y, a_z, \theta]\)). IntuitivnÃ­ a kompaktnÃ­, ale nelze pouÅ¾Ã­t pÅ™Ã­mo na body a vektory.
    \item[Quaternions] (\textit{ÄŒtveÅ™ice}) PodobnÃ© jako \textit{axis + angle}, ale osa rotace je Å¡kÃ¡lovanÃ¡ hodnotou \texttt{sin} hodnoty poloviny Ãºhlu rotace. JednoduchÃ© na interpolaci, lze pouÅ¾Ã­t pÅ™Ã­mo.
\end{description}

\subsubsection*{Quaternions}

UmoÅ¾ÅˆujÃ­ nahradit veÅ¡kerÃ© nÃ¡sobenÃ­ matic a lze je po vÃ½poÄtu na matice opÄ›t pÅ™evÃ©st.

\[
    Q = (\cos{\frac{\varphi}{2}}, x \cdot \sin{\frac{\varphi}{2}}, y \cdot \sin{\frac{\varphi}{2}}, z \cdot \sin{\frac{\varphi}{2}})
\]




% Quaternions: ğ‘„ = (cos ğœ‘ , ğ‘¥ â‹… sin ğœ‘ , ğ‘¦ â‹… sin ğœ‘ , ğ‘§ â‹… sin ğœ‘) 2222
